version: 2

models:
  - name: PROVIDER
    description: The PROVIDER table contains a list of uniquely identified healthcare providers. These are individuals providing hands-on healthcare to patients, such as physicians, nurses, midwives, physical therapists etc.
    columns:
      - name: PROVIDER_ID
        description: It is assumed that every provider with a different unique identifier is in fact a different person and should be treated independently; This identifier can be the original id from the source data provided it is an integer, otherwise it can be an autogenerated number.
        tests:
          - unique:
              severity: warn
          - not_null

      - name: provider_name
        description: This field is not necessary as it is not necessary to have the actual identity of the Provider. Rather, the idea is to uniquely and anonymously identify providers of care across the database.

      - name: npi
        description: This is the National Provider Number issued to health care providers in the US by the Centers for Medicare and Medicaid Services (CMS).

      - name: dea
        description: This is the identifier issued by the DEA, a US federal agency, that allows a provider to write prescriptions for controlled substances.

      - name: SPECIALTY_CONCEPT_ID
        description: This field either represents the most common specialty that occurs in the data or the most specific concept that represents all specialties listed, should the provider have more than one. This includes physician specialties such as internal medicine, emergency medicine, etc. and allied health professionals such as nurses, midwives, and pharmacists; If a Provider has more than one Specialty, there are two options 1. Choose a concept_id which is a common ancestor to the multiple specialties, or, 2. Choose the specialty that occurs most often for the provider. Concepts in this field should be Standard with a domain of Provider.
        tests:
          - not_null
          - relationships:
              to: source('OMOP','CONCEPT')
              field: CONCEPT_ID

      - name: CARE_SITE_ID
        description: This is the CARE_SITE_ID for the location that the provider primarily practices in; If a Provider has more than one Care Site, the main or most often exerted CARE_SITE_ID should be recorded.
        tests:
          - relationships:
              to: ref('CARE_SITE')
              field: CARE_SITE_ID
              severity: warn

      - name: year_of_birth
      - name: GENDER_CONCEPT_ID
        description: This field represents the recorded gender of the provider in the source data; If given, put a concept from the gender domain representing the recorded gender of the provider.
        tests:
          - not_null
          - relationships:
              to: source('OMOP','CONCEPT')
              field: CONCEPT_ID

      - name: provider_source_value
        description: Use this field to link back to providers in the source data. This is typically used for error checking of ETL logic; Some use cases require the ability to link back to providers in the source data. This field allows for the storing of the provider identifier as it appears in the source.

      - name: specialty_source_value
        description: This is the kind of provider or specialty as it appears in the source data. This includes physician specialties such as internal medicine, emergency medicine, etc. and allied health professionals such as nurses, midwives, and pharmacists. Put the kind of provider as it appears in the source data. This field is up to the discretion of the ETL-er as to whether this should be the coded value from the source or the text description of the lookup value.

      - name: SPECIALTY_SOURCE_CONCEPT_ID
        description: Not Applicable - Value:0 (This is often zero as many sites use proprietary codes to store physician speciality; If the source data codes provider specialty in an OMOP supported vocabulary store the concept_id here.)
        # tests:
        #   - accepted_values:
        #       values:
        #         - 0

      - name: gender_source_value
        description: This is provider’s gender as it appears in the source data. Put the provider’s gender as it appears in the source data. This field is up to the discretion of the ETL-er as to whether this should be the coded value from the source or the text description of the lookup value.

      - name: GENDER_SOURCE_CONCEPT_ID
        description: Not Applicable - Value:0 (This is often zero as many sites use proprietary codes to store provider gender; If the source data codes provider gender in an OMOP supported vocabulary store the concept_id here.)
        # tests:
        #   - accepted_values:
        #       values:
        #         - 0



